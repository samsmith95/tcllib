# -*- tcl -*-
# Tests for special functions in math library  -*- tcl -*-
#
# This file contains a collection of tests for one or more of the Tcllib
# procedures.  Sourcing this file into Tcl runs the tests and
# generates output for errors.  No output means no errors were found.
#
# $Id: special.test,v 1.1 2004/06/25 11:27:09 arjenmarkus Exp $
#
# Copyright (c) 2004 by Arjen Markus
# All rights reserved.
#


if {[lsearch [namespace children] ::tcltest] == -1} {
    package require tcltest
    namespace import ::tcltest::*
}

source [file join [file dirname [info script]] math.tcl]
source [file join [file dirname [info script]] special.tcl]

package require math

#
# Expect an accuracy of at least four decimals
#
proc matchNumbers {expected actual} {
   set match 1
   foreach a $actual e $expected {
      if {abs($a-$e) > 1.0e-4} {
         set match 0
         break
      }
   }
   return $match
}

customMatch numbers matchNumbers

test "Erf-1.0" "Values of the error function" \
   -match numbers -body {
   set result {}
   foreach x {0.0 0.1 0.2 0.5 1.0 2.0 -0.1 -0.2 -0.5 -1.0 -2.0} {
      lappend result [::math::special::erf $x]
   }
   set result
} -result {0.0  0.1124629  0.2227026  0.5204999  0.8427008  0.9953227
               -0.1124629 -0.2227026 -0.5204999 -0.8427008 -0.9953227}

proc make_erfc {erf_values} {
   set result {}
   foreach v $erf_values {
      lappend result [expr {1.0-$v}]
   }
   return $result
}

test "Erf-1.1" "Values of the complementary error function" \
   -match numbers -body {
   set result {}
   foreach x {0.0 0.1 0.2 0.5 1.0 2.0 -0.1 -0.2 -0.5 -1.0 -2.0} {
      lappend result [::math::special::erfc $x]
   }
   set result
} -result [make_erfc {0.0  0.1124629  0.2227026  0.5204999  0.8427008 0.9953227
                          -0.1124629 -0.2227026 -0.5204999 -0.8427008 -0.9953227}]


# End of test cases
tcltest::cleanupTests
